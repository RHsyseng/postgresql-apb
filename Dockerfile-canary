FROM ansibleplaybookbundle/apb-base:canary
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.spec"=\
"IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBTaGFyZWQgUGFyYW1ldGVycwojIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIwpfcDogJl9wCiAgLSBuYW1lOiBwb3N0Z3Jlc3FsX2RhdGFiYXNlCiAgICBkZWZh\
dWx0OiBhZG1pbgogICAgdHlwZTogc3RyaW5nCiAgICB0aXRsZTogUG9zdGdyZVNRTCBEYXRhYmFz\
ZSBOYW1lCiAgICByZXF1aXJlZDogdHJ1ZQogIC0gbmFtZTogcG9zdGdyZXNxbF9wYXNzd29yZAog\
ICAgdHlwZTogc3RyaW5nCiAgICBkZXNjcmlwdGlvbjogQSByYW5kb20gYWxwaGFudW1lcmljIHN0\
cmluZyBpZiBsZWZ0IGJsYW5rCiAgICB0aXRsZTogUG9zdGdyZVNRTCBQYXNzd29yZAogIC0gbmFt\
ZTogcG9zdGdyZXNxbF91c2VyCiAgICBkZWZhdWx0OiBhZG1pbgogICAgdGl0bGU6IFBvc3RncmVT\
UUwgVXNlcgogICAgdHlwZTogc3RyaW5nCiAgICBtYXhsZW5ndGg6IDYzCiAgICByZXF1aXJlZDog\
dHJ1ZQogIC0gbmFtZTogcG9zdGdyZXNxbF92ZXJzaW9uCiAgICBkZWZhdWx0OiAnOS41JwogICAg\
ZW51bTogWyc5LjUnLCAnOS40J10KICAgIHR5cGU6IGVudW0KICAgIHRpdGxlOiBQb3N0Z3JlU1FM\
IFZlcnNpb24KICAgIHJlcXVpcmVkOiB0cnVlCiAgICB1cGRhdGFibGU6IHRydWUKIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMKdmVyc2lvbjogMS4wCm5hbWU6IHJoc2NsLXBvc3RncmVzcWwtYXBiCmRl\
c2NyaXB0aW9uOiBTQ0wgUG9zdGdyZVNRTCBhcGIgaW1wbGVtZW50YXRpb24KYmluZGFibGU6IHRy\
dWUKYXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRvY3VtZW50YXRpb25Vcmw6IGh0dHBzOi8v\
d3d3LnBvc3RncmVzcWwub3JnL2RvY3MvCiAgbG9uZ0Rlc2NyaXB0aW9uOiBBbiBhcGIgdGhhdCBk\
ZXBsb3lzIHBvc3RncmVzcWwgOS40IG9yIDkuNS4KICBkZXBlbmRlbmNpZXM6CiAgICAtICdyZWdp\
c3RyeS5hY2Nlc3MucmVkaGF0LmNvbS9yaHNjbC9wb3N0Z3Jlc3FsLTk0LXJoZWw3JwogICAgLSAn\
cmVnaXN0cnkuYWNjZXNzLnJlZGhhdC5jb20vcmhzY2wvcG9zdGdyZXNxbC05NS1yaGVsNycKICBk\
aXNwbGF5TmFtZTogUG9zdGdyZVNRTCAoQVBCKQogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25D\
bGFzczogaWNvbi1wb3N0Z3Jlc3FsCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIElu\
Yy4iCnBsYW5zOgogIC0gbmFtZTogZGV2CiAgICBkZXNjcmlwdGlvbjogQSBzaW5nbGUgREIgc2Vy\
dmVyIHdpdGggbm8gc3RvcmFnZQogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRp\
c3BsYXlOYW1lOiBEZXZlbG9wbWVudAogICAgICBsb25nRGVzY3JpcHRpb246IFRoaXMgcGxhbiBw\
cm92aWRlcyBhIHNpbmdsZSBub24tSEEgUG9zdGdyZVNRTCBzZXJ2ZXIgd2l0aG91dCBwZXJzaXN0\
ZW50IHN0b3JhZ2UKICAgICAgY29zdDogJDAuMDAKICAgIHBhcmFtZXRlcnM6ICpfcAogICAgdXBk\
YXRlc190bzoKICAgICAgLSBwcm9kCiAgLSBuYW1lOiBwcm9kCiAgICBkZXNjcmlwdGlvbjogQSBz\
aW5nbGUgREIgc2VydmVyIHdpdGggcGVyc2lzdGVudCBzdG9yYWdlCiAgICBmcmVlOiB0cnVlCiAg\
ICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IFByb2R1Y3Rpb24KICAgICAgbG9uZ0Rlc2Ny\
aXB0aW9uOiBUaGlzIHBsYW4gcHJvdmlkZXMgYSBzaW5nbGUgbm9uLUhBIFBvc3RncmVTUUwgc2Vy\
dmVyIHdpdGggcGVyc2lzdGVudCBzdG9yYWdlCiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0\
ZXJzOiAqX3AK"

COPY roles /opt/ansible/roles
COPY playbooks/* /opt/apb/actions/
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
