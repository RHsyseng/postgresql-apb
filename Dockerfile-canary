FROM ansibleplaybookbundle/apb-base:canary
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.spec"=\
"IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBTaGFyZWQgUGFyYW1ldGVycwojIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIwpfcDogJl9wCiAgLSBuYW1lOiBwb3N0Z3Jlc3FsX2RhdGFiYXNlCiAgICBkZWZh\
dWx0OiBhZG1pbgogICAgdHlwZTogc3RyaW5nCiAgICB0aXRsZTogUG9zdGdyZVNRTCBEYXRhYmFz\
ZSBOYW1lCiAgICByZXF1aXJlZDogdHJ1ZQogIC0gbmFtZTogcG9zdGdyZXNxbF9wYXNzd29yZAog\
ICAgdHlwZTogc3RyaW5nCiAgICBkZXNjcmlwdGlvbjogQSByYW5kb20gYWxwaGFudW1lcmljIHN0\
cmluZyBpZiBsZWZ0IGJsYW5rCiAgICB0aXRsZTogUG9zdGdyZVNRTCBQYXNzd29yZAogIC0gbmFt\
ZTogcG9zdGdyZXNxbF91c2VyCiAgICBkZWZhdWx0OiBhZG1pbgogICAgdGl0bGU6IFBvc3RncmVT\
UUwgVXNlcgogICAgdHlwZTogc3RyaW5nCiAgICBtYXhsZW5ndGg6IDYzCiAgICByZXF1aXJlZDog\
dHJ1ZQogIC0gbmFtZTogcG9zdGdyZXNxbF92ZXJzaW9uCiAgICBkZWZhdWx0OiAnOS41JwogICAg\
ZW51bTogWyc5LjUnLCAnOS40J10KICAgIHR5cGU6IGVudW0KICAgIHRpdGxlOiBQb3N0Z3JlU1FM\
IFZlcnNpb24KICAgIHJlcXVpcmVkOiB0cnVlCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCnZlcnNp\
b246IDEuMApuYW1lOiByaHNjbC1wb3N0Z3Jlc3FsLWFwYgpkZXNjcmlwdGlvbjogU0NMIFBvc3Rn\
cmVTUUwgYXBiIGltcGxlbWVudGF0aW9uCmJpbmRhYmxlOiB0cnVlCmFzeW5jOiBvcHRpb25hbApt\
ZXRhZGF0YToKICBkb2N1bWVudGF0aW9uVXJsOiBodHRwczovL3d3dy5wb3N0Z3Jlc3FsLm9yZy9k\
b2NzLwogIGxvbmdEZXNjcmlwdGlvbjogQW4gYXBiIHRoYXQgZGVwbG95cyBwb3N0Z3Jlc3FsIDku\
NCBvciA5LjUuCiAgZGVwZW5kZW5jaWVzOgogICAgLSAncmVnaXN0cnkuYWNjZXNzLnJlZGhhdC5j\
b20vcmhzY2wvcG9zdGdyZXNxbC05NC1yaGVsNycKICAgIC0gJ3JlZ2lzdHJ5LmFjY2Vzcy5yZWRo\
YXQuY29tL3Joc2NsL3Bvc3RncmVzcWwtOTUtcmhlbDcnCiAgZGlzcGxheU5hbWU6IFBvc3RncmVT\
UUwgKEFQQikKICBjb25zb2xlLm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6IGljb24tcG9zdGdyZXNx\
bAogIHByb3ZpZGVyRGlzcGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgpwbGFuczoKICAtIG5hbWU6\
IGRldgogICAgZGVzY3JpcHRpb246IEEgc2luZ2xlIERCIHNlcnZlciB3aXRoIG5vIHN0b3JhZ2UK\
ICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogRGV2ZWxvcG1l\
bnQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBUaGlzIHBsYW4gcHJvdmlkZXMgYSBzaW5nbGUgbm9u\
LUhBIFBvc3RncmVTUUwgc2VydmVyIHdpdGhvdXQgcGVyc2lzdGVudCBzdG9yYWdlCiAgICAgIGNv\
c3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOiAqX3AKICAgIHVwZGF0ZXNfdG86CiAgICAgIC0gcHJv\
ZAogIC0gbmFtZTogcHJvZAogICAgZGVzY3JpcHRpb246IEEgc2luZ2xlIERCIHNlcnZlciB3aXRo\
IHBlcnNpc3RlbnQgc3RvcmFnZQogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRp\
c3BsYXlOYW1lOiBQcm9kdWN0aW9uCiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVGhpcyBwbGFuIHBy\
b3ZpZGVzIGEgc2luZ2xlIG5vbi1IQSBQb3N0Z3JlU1FMIHNlcnZlciB3aXRoIHBlcnNpc3RlbnQg\
c3RvcmFnZQogICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczogKl9wCg=="

COPY roles /opt/ansible/roles
COPY playbooks/* /opt/apb/actions/
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
